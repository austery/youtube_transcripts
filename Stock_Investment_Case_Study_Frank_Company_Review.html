<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>个股投资案例分析：Frank的公司股票投资复盘</title>
    <script src="https://unpkg.com/turndown/dist/turndown.js"></script>
    <style>
        /* === 基础与布局 === */
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; line-height: 1.6; margin: 0; padding: 20px; background-color: #f9f9f9; color: #333; }
        .report-container { display: flex; flex-direction: row; gap: 25px; max-width: 1200px; margin: 20px auto 0 auto; }

        /* === 元数据区块 === */
        .metadata-block { background-color: #eef2f7; border-left: 5px solid #007bff; padding: 15px 20px; margin-bottom: 25px; border-radius: 8px; font-size: 0.9em; max-width: 1200px; margin: 0 auto; }
        .metadata-block p { margin: 5px 0; color: #555; }
        .metadata-block strong { color: #333; margin-right: 8px; }
        .metadata-block a { color: #007bff; text-decoration: none; font-weight: bold; }
        .metadata-block a:hover { text-decoration: underline; }

        /* === 目录侧边栏 === */
        .sidebar-toc { flex: 0 0 250px; position: sticky; top: 20px; align-self: flex-start; max-height: 90vh; overflow-y: auto; padding: 15px; background-color: #fff; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .sidebar-toc h3 { margin-top: 0; font-size: 1.1em; border-bottom: 1px solid #eee; padding-bottom: 10px; }
        .sidebar-toc ul { list-style: none; padding: 0; margin: 0; }
        .sidebar-toc li a { text-decoration: none; color: #007bff; display: block; padding: 8px 0; transition: color 0.2s; }
        .sidebar-toc li a:hover { color: #0056b3; }

        /* === 主内容区 === */
        .main-content { flex: 1; background-color: #fff; padding: 20px 30px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .main-content h1, .main-content h2, .main-content h3 { color: #222; }
        .main-content h2 { border-bottom: 2px solid #f0f0f0; padding-bottom: 10px; margin-top: 40px; }
        .main-content h3 { border-bottom: 1px solid #f0f0f0; padding-bottom: 8px; margin-top: 30px; }
        .main-content p b { color: #333; }

        /* === 响应式设计 === */
        @media (max-width: 768px) {
            .report-container { flex-direction: column; }
            .sidebar-toc { position: static; flex-basis: auto; width: 100%; max-height: none; box-sizing: border-box; }
        }
    </style>
</head>
<body>

    <div class="metadata-block">
        <p><strong>主持人:</strong> Lei</p>
        <p><strong>嘉宾:</strong> Frank, Vivian, Zhao Rui, Wang Will, Alvin</p>
        <p><strong>视频URL:</strong> <a href="[视频的完整链接]" target="_blank">点击观看原始视频</a></p>
    </div>

    <div class="report-container">
        <aside id="toc-container" class="sidebar-toc"></aside>
        <main id="content-body" class="main-content">
            <h1>个股投资案例分析：Frank的公司股票投资复盘</h1>
            
            <h2>引言：抓住疫情带来的逆向投资机会</h2>

            <p><b>Frank:</b> 大家好，我看不到大家，就只能看到屏幕。今天我想和大家分享一个股票投资的案例。我们之前讨论了很多关于指数投资的内容，我觉得相互借鉴、开阔眼界，受益匪浅。我这次分享的是一个发生在2020年的个股投资案例。</p>

            <p><b>Frank:</b> 2020年，当时新冠疫情传到加拿大和北美，整个股票市场都在大跌，跌得非常厉害。当时我就想，股市大跌，机会来了，这就是逆向投资。跌的时候其实应该感到高兴。面对那么多下跌的股票，我应该投资哪一只，哪个机会是我能把握的？一时间我也毫无头绪。</p>

            <p><b>Frank:</b> 后来，我决定从自己熟悉的公司入手。我当时刚换了工作，而我上一家公司是一家上市公司。这家公司生产一种叫做OSB（Oriented Strand Board，定向刨花板）的产品。</p>

            <h3>产品与行业背景</h3>

            <p><b>Frank:</b> 它只生产这种定向刨花板，主要用于建造房子，比如墙体和地板（Subfloor）。就像照片上显示的那样，房子里用的这种木板就是我们公司生产的。所以，房屋建材中有很大一部分是我当时供职公司生产的产品。这家公司当时叫Norboard，股票代码就是OSB。</p>

            <p><b>Frank:</b> 这种产品是后来新发明的，用以替代胶合板（Plywood）。在OSB出现之前，建筑材料中的墙体和地板都是用胶合板。相比之下，胶合板有很多缺点，这里就不具体展开了。OSB算是一种产品的更新换代。这是一个很小的行业，生产这种建材的公司屈指可数，一两只手就能数得过来。</p>

            <h2>行业分析：一个高度集中的寡头垄断市场</h2>

            <p><b>Frank:</b> 我当时工作的这家公司Norboard是行业第一，年产量大约是860万立方米。第二名是LP（Louisiana-Pacific），这是全球前十的玩家。如果只看北美市场，玩家就更少了，行业非常集中。</p>

            <p><b>Frank:</b> 大家可以看这张幻灯片的左半部分，在北美市场，Norboard一家的市场份额就占到了29%。第二家LP公司占18%，我曾去他们公司面试，也参观过他们的生产现场。第三家是GP（Georgia-Pacific），市场份额占15%。所以你看，仅前三家公司的市场占有率合计就达到了62%，市场集中度非常高。</p>

            <p><b>Frank:</b> 如果把前四家，也就是加上Weyerhaeuser，这四家公司的市场占有率合计达到了73%。我们重点关注北美市场。在欧洲，有一家瑞典公司就占据了将近40%的市场份额。所以，这个行业非常集中，是一个寡头垄断（Oligopoly：指少数几家大公司控制整个市场供给的格局）型的市场。对我来说，这个行业就非常容易理解，因为公司少，产品也非常单一。</p>

            <h3>深入了解生产与成本</h3>

            <p><b>Frank:</b> 而且我在公司工作过，专门负责生产流程和生产线，对这种产品如何生产出来以及其成本结构都非常清楚。我工作的那家公司在全球，主要是在北美，有十几家工厂，每家工厂的生产能力是多少，都很容易分析出来。这就是一个典型的生产工厂，我当时就在其中一家负责生产。</p>

            <p><b>Frank:</b> 你把整个北美行业的生产能力放在一起看，也是一目了然的。全北美的工厂主要分布在美国和加拿大，数量有限。图上蓝色的代表正在生产的工厂，黄色的代表停产的。所以整个行业的生产能力和分布都非常清晰。前面说的这些都指向一点：这个行业产品单一，行业结构高度集中，非常容易分析。大家有问题可以随时打断我。</p>

            <h2>核心问题：盈利能力与价格周期的探索</h2>

            <p><b>Frank:</b> 当时我花了几个月时间，把北美排名前几的这几家公司的历史年报全部打印出来，一份一份地阅读，去理解他们的市场数据。我脑子里有一个问题，并且发现了一个很明显的现象：这家公司的盈利与否，完全受其产品市场价格的影响。而这个产品，是一个大宗商品。</p>

            <p><b>Frank:</b> 这种产品不像iPhone或笔记本电脑，它的标准和石油、铁矿石一样，是大宗商品。大宗商品的价格是由供求关系决定的。整个行业的盈利能力，完全由这个产品的市场价格决定。当时我就觉得，如果我能找到它市场价格的规律，那么这个企业的盈利能力就非常容易预测了。</p>

            <h3>寻找价格中枢与盈利敏感性</h3>

            <p><b>Frank:</b> 那么，它的市场价格到底是怎么样的？与盈利能力又是什么关系？我去看这家公司15年的数据。因为它后来收购了另一家公司，为了追溯历史数据，我把两家公司在收购前的生产能力和财务报表合并分析。我发现，它15年来的平均EBITDA（税息折旧及摊销前利润：衡量公司核心盈利能力的指标）大约在3.3亿美元。</p>

            <p><b>Frank:</b> 由于大宗商品受市场价格和经济行情波动影响，有时价格高，盈利能力强；有时价格不好，可能全行业亏损。但把15年拉平来看，能看到它平均的年盈利能力大概在3.3亿美元。然后我再去看这个产品的大宗商品市场价格，花了很长时间去研究其价格的驱动因素。</p>

            <p><b>Frank:</b> 后来我发现，可以找到它15年来的价格中枢值。这个产品的市场价格15年平均值大约在每千平方英尺253美元。大家看这张幻灯片，里面提到了公司盈利对产品价格的敏感性分析。当产品价格上下变动10美元，对公司的EBITDA影响大约是5300万美元。也就是说，价格每上涨10美元，其盈利就增加5300万；反之亦然。这是历史平均价格的情况。</p>

            <h2>需求与供给分析</h2>

            <h3>需求端：稳定的新屋开工量</h3>

            <p><b>Frank:</b> 那么另一个问题是，这个公司要达到盈亏平衡点，市场价格应该是多少？当时我通过阅读所有财报、听管理层业绩会议、研究同行的财务报告，自己估算出了这个数据。我当时估算的市场价格比这个还要低一些，它就能实现盈利了。</p>

            <p><b>Frank:</b> 另外，当COVID-19来临时，全球都非常恐慌。这个行业也很恐慌，因为大家都觉得不会再盖房子了，产品主要用在新建房上，市场需求会消失。这个需求什么时候会回来？行业前景怎么样？这在当时也是我脑中的一个大问题。</p>

            <p><b>Frank:</b> 但我深入思考后，找到了这个行业的驱动力，那就是美国的新屋开工量（Housing Starts：衡量特定时期内新建私人住宅项目开工数量的经济指标）。加拿大和各个城市也都会发布这个数据，是房地产行业一个主要的追踪指标。我去追踪了美国统计局每月发布的US Housing Starts数据，分析了它的历史数据和趋势。</p>

            <p><b>Frank:</b> 分析到这个程度后我发现，美国房地产市场其实存在一个巨大的建造缺口。从08年金融危机后，很多人选择和父母同住，房屋购买量减少，整个新屋建造量连续多年远低于历史水平。多年积攒下来，就形成了一个新屋建造量的缺口。未来很多年，其实都需要去弥补这个缺口。所以，美国房地产新屋开工量未来是会稳步上涨的。这个情况在加拿大也适用，加拿大也存在大量的新屋建造落后于实际市场需求的情况。</p>

            <h3>供给端：寡头的默契与产能瓶颈</h3>

            <p><b>Frank:</b> 另一方面，你再看市场供给。总共就三四个主要玩家，占了70%的市场份额。你把这四家的总体生产能力和开工量放在一起，就能看到这个行业的繁荣指数。需求端是稳定的，不会因为疫情的短期冲击而改变长期历史趋势。再看生产能力，这个行业是寡头垄断，大家都有自己的开工和投产计划。</p>

            <p><b>Frank:</b> 整个行业很多年没有新工厂投入，大家只是把现有工厂的生产能力运转到最大，所以生产能力很稳定。如果有新玩家想建厂，就会增加供应，打破供需平衡。但我在这个行业工作过，知道新开一个工厂，从开工到建成需要三年，建成后还需要大约三年的生产爬坡期，才能达到完全顺畅的生产状态。总共需要六年时间。</p>

            <p><b>Frank:</b> 所以，这个行业的需求是稳定的，而开工率基本保持在80%多接近90%，说明行业的供给能力已经处于瓶颈。供需关系很稳定，长期看，行业不会受到根本性的影响，其市场价格也会相对稳定，整个行业的盈利是很容易预测的。</p>

            <h2>投资论证：估值与安全边际</h2>

            <h3>计算盈亏平衡点与行业默契</h3>
            
            <p><b>Frank:</b> 这时候，我自己分析出来，对于我所工作的这家企业，由于它是行业龙头，它的价格底线基本就是行业的底线。我当时根据数据估算，只要这个产品的市场价格在197美元，这个企业就能打平，不亏不赚。只要市场价格低于197美元，全行业就陷入亏损。</p>

            <p><b>Frank:</b> 我还发现这个行业有个特征，因为是三四个玩家管控，每次当市场行情不好时，龙头企业Norboard就会带头减产，关闭或缩减一些工厂的产能。当它这样做的时候，第二、三、四名都会采取同样的行动。这其实是一种行业默契，是典型的寡头垄断价格协议。行情不好时，龙头一带头，大家集体缩减产量。供给少了，市场价格就会回升。他们这几个寡头其实是在通过调整行业产量来调控市场价格，所以很少会击穿这个价格底线。</p>

            <p><b>Viya:</b> 我想问一下，如果它的价格是由大宗商品决定的，那么它的成本方面是否也会跟着大宗商品的改变而改变呢？</p>
            
            <p><b>Frank:</b> 它的成本结构是相对固定的。主要有几块：第一是木料，即原材料成本；第二是生产过程中用到的化学品和能源（如天然气）成本；第三是很大的人工成本；第四是一次性的工厂建造成本，这个投入高达数亿美元，每年要进行折旧。这种产品用的木材，是那种没有建材使用价值的废木或野木，所以原材料成本相对便宜，大约占30%，人工成本占20%左右。它的成本结构不受市场木材产品价格的影响。你说的木材价格走高，那个木材是建筑产品（Lumber），不是原材料。树木本身的价格变动不大。</p>

            <p><b>Lei:</b> 那我想问一下，我们感觉过去两年修栅栏的木材价格差别很大，你说生产成本不变，这是为什么？</p>

            <p><b>Frank:</b> 你提的这个问题很好。木材行业和这个OSB行业很类似。当时木材价格先降后涨，上涨的原因是所有木材生产厂家都关闭工厂、缩减产能，导致生产能力大幅下降。但同时，大家待在家里没事干，都开始搞家庭装修（renovation），市场对木材的需求反而上来了。生产端的下降远大于需求端的下降，这几个行业巨头人为地造成了行业短缺，所以当时木材价格狂涨，OSB板材也是一样。</p>
            
            <h3>估值计算：发现被严重低估的价值</h3>

            <p><b>Frank:</b> 好了，回到我的分析。15年的平均市场价格是253美元，盈亏平衡点是197美元。价格每增加10美元，盈利增加5300万美元。那么，在253美元的平均价格下，比盈亏平衡点高出大约56美元。你用5.6去乘以5300万，就能算出公司在市场平均价格下的平均盈利能力。算出来大概是3.3亿美元的EBITDA。我保守估计，它的净利润大概在2亿到2.5亿美元之间。这是我个人估算的。</p>

            <p><b>Frank:</b> 现在，所有这些我都算出来了，我就在想，这家公司到底值多少钱？行业前景我看得很清楚，需求稳定，供给稳定，寡头有默契。现在就是如何对这个企业估值。大家有什么看法吗？</p>

            <p><b>Viya:</b> 理论上，这种公司的估值是按未来现金流的折现价格来算。就是用你预测的2到2.5亿的年现金流，折现一个年限，比如30年，然后算回来。</p>

            <p><b>Frank:</b> 对，可以这么算。我当时看到的情况是，疫情来了之后，它的股价从40美元左右猛跌，到4月3号最低跌到了8.92美元。这个企业发行的总股数是8150万股，当时的总市值只有7.27亿，就算7.3亿美元。而这家企业每年能盈利2亿到2.5亿美元。它现在的市值只有7.3亿，大家觉得这个价值怎么样？</p>

            <p><b>Viya:</b> 非常低。因为它将近四年就能完全赚回它的市值了。</p>
            
            <p><b>Frank:</b> 对，差不多四年就可以把这家公司白赚回来。所以我们看市盈率（P/E Ratio：股价与每股收益的比率，常用来评估股价水平是否合理），用它的市值除以盈利能力。如果保守按每年挣2亿美元算，7.27亿除以2亿，P/E是3.6倍。也就是说，我只需要3.6年就能回本。如果乐观一点，按每年挣2.5亿美元算，P/E只有2.9倍，大概3年就能回本。</p>
            
            <p><b>Frank:</b> 这是一个非常稳定的成熟行业，所以这个信息是基于行业供需稳定的前提。我觉得这个安全边际（Margin of Safety：投资中，指资产的内在价值高于其市场价格的差额）已经足够大了。那么合理的估值应该是多少？一般如果按10倍P/E估值，意味着你投入一笔钱，大约十年能收回本金。如果它每年盈利2.5亿美元，乘以10，公司市值应该是25亿美元。对于美国一些成熟稳定的企业，估值一般会给到15倍。如果按15倍估算，它的市值应该是37.5亿美元。</p>
            
            <p><b>Frank:</b> 所以，这家公司保守的估值是25亿美元，乐观的估算是37.5亿美元。而它当时的市场价值只有7.3亿美元。这意味着，它回到合理估值至少有3到5倍的上涨空间。这就是我对这家企业的估值。当时我分析完之后，在四月底五月份得出的结论就是，这时候买入肯定是非常划算的。</p>
            
            <h3>结局验证：被高价收购</h3>

            <p><b>Frank:</b> 后来，我也就开始买入。这家公司最后涨到多少呢？在2020年年底，它涨到了43块多，从8块多涨到43块，大概涨了5倍。更有意思的事情发生在2020年10月9日，这家公司被West Fraser收购了。West Fraser是北美生产木材（Lumber）最大的公司之一。它花了多少钱收购呢？报价是31亿美元。</p>

            <p><b>Frank:</b> 你看，这家公司来收购，出的价格是31亿美元。我当时基于盈利能力，估算它的市值在25亿到37.5亿美元之间。结果另一家公司就以31亿美元的价格来收购它。我算了一下，这个收购价对应的市盈率是多少？拿31亿除以它历年平均的2.5亿盈利能力，大概是12.4倍的市盈率，正好在10倍和15倍之间。所以，West Fraser的出价也是一个非常合理的市场价。这件事发生后，就验证了我当时对这家公司判断的逻辑是正确的。更有意思的是，West Fraser这家公司，就是我辞职后去的第二家公司。我第二家公司把我第一家公司给收购了。</p>

            <h2>总结与反思：从案例中学到的投资原则</h2>

            <h3>能力圈与安全边际的重要性</h3>

            <p><b>Frank:</b> 这就是我当时在疫情期间寻找投资机会的过程。我之所以能找到这家公司并进行分析，首先是因为它在我的能力圈（Circle of Competence：投资概念，指投资者对自己真正理解的领域或行业的认知边界）之内。我从自己熟悉的公司，甚至是工作过的公司入手。我对木材行业、对加拿大的林业都很有兴趣，也花了很多时间研究，所以分析完之后很有信心。第二，就是对企业进行估值，并且寻找足够大的安全边jection。这个企业你买了之后，三年就能回本，而正常十年回本就算合理，这个安全边际就足够大，风险很低。</p>
            
            <p><b>Frank:</b> 另外，我也感受到行业格局的影响。这个行业很好分析，因为总共就三四家公司，财报容易理解，产品成本结构、盈利能力、行业驱动力都非常清楚。它是一个寡头垄断行业，不像石油或者餐饮业，玩家太多，难以分析。</p>

            <h3>周期性行业与择时的陷阱</h3>

            <p><b>Frank:</b> 最后一点，我发现这是一个周期性行业。疫情来临时，大家都在赔钱，股价很低，这是行业的低谷期。我觉得低谷期正是投资的好时机。我得出的一个结论是，对于周期性行业，要在行业低谷、大家都不挣钱的时候买入，因为这时候已经跌无可跌，只能向上走。</p>

            <p><b>Frank:</b> 但是，我在择时上犯了错误。我当时买了之后，虽然觉得长久拿着肯定不错，但不知道它要多久才会涨。它涨了一段时间又跌，我就想做波段操作，高抛低吸。结果，挣了一些小钱后，再等它跌下来，它就再也跌不回来了，一骑绝尘地涨了上去。所以，我发现市场真的很难择时（Time the market）。</p>

            <p><b>Frank:</b> 这个案例让我学到很多，虽然因为择时错过了主要的涨幅——它从低点算起，合并后新公司的股价继续上涨，总共涨了十倍——但我没有抓住。不过，我用同样的思维方式，后来又找到了另外两个机会，其中一个抓住了，也获得了大约七倍的回报。</p>

            <h2>延伸讨论：从个股到房地产与投资心态</h2>

            <h3>赵瑞的观点：投资目标与克服人性冲动</h3>

            <p><b>Zhao Rui:</b> 我虽然没听到前面的分享，但听到了择时这个话题。其实我们投资要不忘初心，你的投资目标到底是什么，这非常重要。你看我最近一直在买特斯拉，从它宣布Robotaxi Day后下跌时就开始准备买入。我动作慢了点，结果它“蹭”地就涨起来了，搞得我很郁闷。</p>
            
            <p><b>Zhao Rui:</b> 这就是择时的问题。后来我想，我给自己设定了一个心理账户，我现在买的这一批就是奔着2030年去的。如果我把目标看到那么远，现在买入就不是很纠结了。我们这些早期投资者都经历过这些，心服口服地承认，我们抄不到底，所以就放弃择时了。只要认定目标，就分批买入，然后就不管了。</p>

            <h3>王哥的分析：多伦多公寓市场的机会与风险</h3>
            
            <p><b>Wang Ge:</b> 我补充一点房地产的看法。现在多伦多和温哥华的房地产都陷入了特别恐怖的状态。巴菲特说“别人恐惧时我贪婪”，我们兴奋的点在哪里？有两个。第一是多伦多的多户型（Multiplex）翻建政策。第二是我们很兴奋的点，就是市中心的公寓（Condo）。</p>
            
            <p><b>Wang Ge:</b> 市中心公寓的价格现在甚至和奥克维尔那边差不多了，50万以下的公寓很容易找到。但真正的机会可能在明年，明年有大约4万套公寓要交房，那才是最惨的时候。我们和专门做公寓投资的杨红聊过，他给的数据显示，由于现在没人盖新楼，到2027年、2028年，新交房的公寓数量会直线下降到几千套，2029年甚至只有1000套。这其实就是一个机会。</p>
            
            <p><b>Wang Ge:</b> 如果要投资公寓，我们的原则是：第一，买便宜的，有45万的不买50万的。第二，尽量买新楼，这样不受租金管制条例影响。第三，看管理费。我们行业内有一个标准，管理费如果超过每平方英尺0.9或1块钱，我们就不做投资了。因为超过这个标准，老化和出问题的速度会加速。投资公寓不能一直持有，到了一定时候，比如管理费过高了，就应该卖掉换新的。</p>

            <h3>Owen的补充：物业管理的视角</h3>

            <p><b>Owen:</b> 我是做物业租赁管理的。刚才王哥说的管理费那条线，跟我们行业内的标准完全一致。只要物业报告（Strata documents）显示平均每尺管理费超过9毛或1块，我们连考虑都不会考虑，因为这基本意味着房子以前出过事。</p>
            
            <p><b>Owen:</b> 我发现房地产投资跟股票有很多相似之处，比如需要设定明确的卖出时机和目标。没有哪个房子能一直持有下去。而且，房地产投资的每一步都可能比炒股更复杂，比如装修、租客、融资等等，每一环都充满了不确定性。最终，作为投资人，还是得有自己的原则和勇气，并且坚持下去。</p>
            
            <h3>关于“失去的十年”与长期投资</h3>

            <p><b>Wang Ge:</b> 我看了一张从1870年到现在的市场走势图，发现历史上经常出现“失去的十年”（Lost Decade），比如从2000年科网泡沫破灭到2013年，市场基本不涨不跌。我们都四十多岁了，如果遇到一个15年的平台期，到60岁了还没回本，该怎么办？</p>
            
            <p><b>Zhao Rui:</b> 所以投资股票一定要早。但即使在“失去的十年”里，如果你坚持定投，最后的结果也并不会真的“失去”。对我们这个岁数的人来说，投资必须考虑年龄。除了在股市里放一部分钱，还应该持有一些房地产，更重要的是要有自己的生意或赚钱能力。你不能只靠投资，得让自己变得很强才行。</p>

            <div class="action-buttons">
                <button id="copy-md-button">一键复制为Markdown</button>
            </div>
        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            if (document.getElementById('toc-container') && document.getElementById('toc-container').innerHTML.trim() === "") {
                generateTableOfContents();
            }
            initializeCopyToMarkdown();
        });

        function generateTableOfContents() {
            const contentBody = document.getElementById('content-body');
            const tocContainer = document.getElementById('toc-container');
            if (!contentBody || !tocContainer) return;

            const headings = contentBody.querySelectorAll('h2, h3');
            if (headings.length > 0) {
                tocContainer.innerHTML = '<h3>目录</h3>';
                const tocList = document.createElement('ul');
                headings.forEach((heading, index) => {
                    const id = `heading-${index}`;
                    heading.setAttribute('id', id);
                    const listItem = document.createElement('li');
                    const link = document.createElement('a');
                    link.setAttribute('href', `#${id}`);
                    link.textContent = heading.textContent;
                    
                    if (heading.tagName === 'H3') {
                        listItem.style.paddingLeft = '15px';
                    }

                    listItem.appendChild(link);
                    tocList.appendChild(listItem);
                });
                tocContainer.appendChild(tocList);
            } else {
                tocContainer.style.display = 'none';
            }
        }

        function initializeCopyToMarkdown() {
            const copyButton = document.getElementById('copy-md-button');
            if (!copyButton) return;

            copyButton.addEventListener('click', () => {
                const contentBody = document.getElementById('content-body').cloneNode(true);
                // 移除按钮容器防止被复制
                const buttonContainer = contentBody.querySelector('.action-buttons');
                if (buttonContainer) {
                    buttonContainer.remove();
                }

                if (typeof TurndownService === 'function') {
                    var turndownService = new TurndownService({ headingStyle: 'atx' });
                    var markdown = turndownService.turndown(contentBody);
                    
                    navigator.clipboard.writeText(markdown).then(() => {
                        copyButton.textContent = '复制成功!';
                        setTimeout(() => { copyButton.textContent = '一键复制为Markdown'; }, 2000);
                    }).catch(err => {
                        console.error('复制失败: ', err);
                        copyButton.textContent = '复制失败';
                    });
                }
            });
        }
    </script>

</body>
</html>